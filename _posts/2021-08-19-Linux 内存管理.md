# Linux 内存管理

## 概念

### 碎片

#### 内部碎片（Internal Fragmentation）
对于已分配的块（即归属于某一进程），如果有效负载（程序请求的大小）比块大小小，就会产生内部碎片。

#### 外部碎片（External Fragmentation）
频繁分配回收导致某些块（太小）不满足进程要求而无法分配出去的块（即不属于任何进程），这些无法被利用起来的块就是外部碎片。


## 分配

### 基本策略
下面几种分配策略都是内存分配的肤浅策略，真实场景下的内存分配要复杂得多。

#### 最优匹配（best fit）
遍历整个空闲列表，将空间大小比所请求大小大的块作为候选，取其中**最小**的作为结果返回。这样需要遍历整个空闲列表，但是可以避免内存空间浪费。

#### 最差匹配（worst fit） 
遍历整个空闲列表，将空间大小比所请求大小大的块作为候选，取其中**最大**的最作为结果返回。目的是为了保留较大的块，但是遍历花费的开销大，还容易导致过量的碎片。

#### 最先匹配（first fit）
在遍历过程中找到符合条件的块就直接返回，性能较好。有时会造成头部很多小碎片，所以这种策略需要考虑如何管理空闲列表的顺序。


